<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nikolas & Kavita — Wedding Invitation</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<style>
:root{--wine:#7b1733;--wine-soft:#fdebef;--ink:#1f2937}
html,body{height:100%;overflow-x:hidden}
body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--ink)}
/* Background (image + fallback gradient) */
.hero-bg{
  position:fixed;inset:0;z-index:-3;
  background:
    url('/assets/hero.jpg') center/cover no-repeat,
    linear-gradient(135deg,#7b1733,#a91d47);
  filter:brightness(.9) saturate(1.05);
}
.wine-overlay{
  position:fixed;inset:0;z-index:-2;
  background:
    radial-gradient(80% 70% at 50% 15%,rgba(123,23,51,.18),transparent 60%),
    linear-gradient(180deg,rgba(20,6,10,.35),rgba(20,6,10,.60));
}
/* Petals */
#petalsCanvas{position:fixed;inset:0;z-index:1;pointer-events:none;opacity:0;transition:opacity 1s ease}
#petalsCanvas.active{opacity:1}
/* Music control */
.music-control{position:fixed;top:.75rem;right:.75rem;z-index:100;background:rgba(255,255,255,.92);border:none;border-radius:.65rem;padding:.5rem .8rem;cursor:pointer;font-weight:600;color:var(--wine);box-shadow:0 6px 16px rgba(0,0,0,.2)}
/* Tap-to-begin */
#touchIntro{position:fixed;inset:0;z-index:60;display:flex;align-items:center;justify-content:center;gap:1rem;color:#fff;text-align:center;padding:2rem;transition:opacity .6s ease,visibility .6s ease}
#touchIntro.hidden{opacity:0;visibility:hidden;pointer-events:none}
.name-text{font-family:"Playfair Display",serif;font-size:clamp(28px,8vw,60px);font-weight:700;text-shadow:0 2px 14px rgba(0,0,0,.45);opacity:0;transform:translateY(16px);animation:fadeUp 1s ease forwards}
.name-left{transform:translateX(-40px);animation-delay:.2s}
.name-right{transform:translateX(40px);animation-delay:.2s}
.name-merge .name-left,.name-merge .name-right{transform:translateX(0)}
.heart-btn{position:relative;width:clamp(84px,16vw,124px);height:clamp(84px,16vw,124px);background:none;border:none;padding:0 12px;cursor:pointer;z-index:70;opacity:0;animation:fadeUp 1s ease forwards;animation-delay:.35s;-webkit-tap-highlight-color:transparent}
.heart-btn:hover{transform:translateY(-2px)}
.heart-svg-wrapper{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;animation:pulse 1.5s infinite}
.heart-svg{width:100%;height:100%;filter:drop-shadow(0 8px 16px rgba(0,0,0,.45))}
/* Blood-red heart */
.heart-svg path{fill:#960018;stroke:#7b0013;stroke-width:1.2px}
.heart-btn .touch-text{color:#fff;text-shadow:0 1px 3px rgba(0,0,0,.6);pointer-events:none}
.heart-btn.floating{animation:float 3s ease-in-out infinite}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.08)}100%{transform:scale(1)}}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
@keyframes fadeUp{to{opacity:1;transform:none}}
/* Intro reel */
.intro-sequence{position:fixed;inset:0;z-index:50;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;flex-direction:column;color:#fff;text-align:center;padding:2rem;transition:opacity .6s ease,visibility .6s ease}
.intro-sequence.hidden{opacity:0;visibility:hidden;pointer-events:none}
.intro-text{font-family:"Playfair Display",serif;font-size:clamp(24px,5vw,48px);line-height:1.35;opacity:0;transform:translateY(26px);animation:fadeInUp 1s ease forwards;margin-bottom:2rem;text-shadow:0 4px 20px rgba(0,0,0,.5)}
.intro-names{font-size:clamp(32px,7vw,64px);font-weight:700;color:var(--wine-soft);text-shadow:0 4px 20px rgba(123,23,51,.8)}
.skip-intro{position:absolute;bottom:24px;right:24px;background:rgba(255,255,255,.25);border:1px solid rgba(255,255,255,.35);color:#fff;padding:10px 18px;border-radius:24px;cursor:pointer}
@keyframes fadeInUp{to{opacity:1;transform:translateY(0)}}
/* Main */
.main-content{position:relative;z-index:10;min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem 1rem;opacity:0;transition:opacity 1s ease}
.main-content.visible{opacity:1}
.bible-verse{text-align:center;color:#fff;margin-bottom:3rem;max-width:640px;font-style:italic;line-height:1.6;text-shadow:0 2px 10px rgba(0,0,0,.7)}
.wedding-card{background:linear-gradient(135deg,rgba(255,255,255,.95),rgba(253,235,239,.9));backdrop-filter:blur(20px);border-radius:24px;padding:3rem 2.5rem;max-width:640px;width:100%;text-align:center;box-shadow:0 30px 60px rgba(0,0,0,.3),0 0 0 1px rgba(255,255,255,.2);border:1px solid rgba(123,23,51,.1)}
.ceremony-title,.couple-names{font-family:"Playfair Display",serif;color:var(--wine)}
.ceremony-title{font-size:clamp(24px,5vw,32px);font-weight:700;margin:1rem 0 1.25rem}
.invitation-header{color:var(--ink)}
.parents-info{line-height:1.6}
.couple-names{font-size:clamp(28px,6vw,40px);font-weight:700;margin:1rem 0}
.event-details{margin:1.5rem 0;line-height:1.8}
.event-row{display:flex;justify-content:space-between;gap:.75rem;flex-wrap:wrap;margin:.4rem 0}
.event-label{font-weight:700;color:var(--wine);min-width:80px}
.event-value{flex:1;text-align:right}
.map-link{color:var(--wine);text-decoration:underline}
.action-buttons{margin:2rem 0 1.25rem;display:flex;gap:1rem;justify-content:center;flex-wrap:wrap}
.btn-primary,.btn-outline{padding:12px 22px;border-radius:28px;font-weight:700;cursor:pointer}
.btn-primary{background:var(--wine);color:#fff;border:none}
.btn-outline{background:transparent;color:var(--wine);border:2px solid var(--wine)}
.btn-primary:hover{filter:brightness(.95)} .btn-outline:hover{background:var(--wine);color:#fff}
.color-note{margin-top:1rem;padding:.9rem;border-radius:12px;background:rgba(123,23,51,.1);color:var(--wine);font-style:italic}
.countdown-section{margin-top:2rem;color:#fff;text-align:center}
.countdown-timer{font-family:"Playfair Display",serif;font-size:clamp(24px,5vw,36px);font-weight:700;background:rgba(0,0,0,.3);padding:.8rem 1.4rem;border-radius:14px}
.footer{text-align:center;color:rgba(255,255,255,.85);padding:2rem}
/* Modal */
.modal-overlay{position:fixed;inset:0;z-index:200;background:rgba(0,0,0,.7);backdrop-filter:blur(5px);display:flex;align-items:center;justify-content:center;padding:1rem;opacity:0;visibility:hidden;transition:all .3s ease}
.modal-overlay.visible{opacity:1;visibility:visible}
.modal-content{background:#fff;border-radius:20px;padding:2rem;max-width:500px;width:100%;transform:translateY(18px);transition:transform .3s ease}
.modal-overlay.visible .modal-content{transform:translateY(0)}
.modal-title{font-family:"Playfair Display",serif;font-size:26px;font-weight:700;color:var(--wine);text-align:center;margin:0 0 1rem}
.form-group{margin:.9rem 0}.form-label{display:block;font-weight:600;margin:.4rem 0}.form-input{width:100%;padding:12px 14px;border:2px solid #e5e7eb;border-radius:12px;font-size:16px}
.form-input:focus{outline:none;border-color:var(--wine)}
.btn-cancel{background:#6b7280;color:#fff;border:none;border-radius:24px;padding:10px 18px;font-weight:700;cursor:pointer}
/* Reduced motion */
@media (prefers-reduced-motion:reduce){
  #touchIntro,.intro-sequence{display:none!important}
  #petalsCanvas{display:none!important}
  .main-content{opacity:1!important}
}
@media (max-width:640px){
  .wedding-card{padding:2rem 1.25rem;margin:0 1rem}
  .event-row{flex-direction:column;text-align:center}
  .event-value{text-align:center}
}
</style>
</head>
<body>
<div class="hero-bg"></div><div class="wine-overlay"></div>
<canvas id="petalsCanvas"></canvas>

<!-- music -->
<button class="music-control" id="musicControl" type="button" aria-pressed="false">Music: Off</button>
<audio id="bgm" preload="auto" playsinline loop>
  <source src="/assets/music.mp3" type="audio/mpeg">
</audio>

<!-- intro -->
<div id="touchIntro" role="dialog" aria-modal="true" aria-label="Intro">
  <div id="namesWrap" style="display:flex;align-items:center;gap:1rem">
    <div class="name-text name-left">NIKOLAS</div>
    <button id="heartButton" class="heart-btn" type="button" aria-label="Begin">
      <div class="heart-svg-wrapper">
        <svg class="heart-svg" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
      </div>
      <span class="touch-text">Touch&nbsp;Me</span>
    </button>
    <div class="name-text name-right">KAVITA</div>
  </div>
</div>

<div class="intro-sequence hidden" id="introSequence">
  <div class="intro-text" id="introText">With great joy and gratitude</div>
  <button class="skip-intro" type="button" id="skipIntro">Skip Intro</button>
</div>

<!-- main -->
<div class="main-content" id="mainContent">
  <div class="bible-verse">
    “Place me like a seal over your heart… for love is as strong as death…<br>
    Many waters cannot quench love; rivers cannot sweep it away”
    <div class="verse-reference">— Song of Solomon 8:6–7</div>
  </div>

  <div class="wedding-card">
    <div class="invitation-header">You are cordially invited, together with their families, to the</div>
    <div class="ceremony-title">WEDDING CEREMONY</div>

    <div class="parents-info">
      s/o Samson Nicholas D'Costa and Suni Samson D'Costa,<br>
      <div class="couple-names">NIKOLAS &amp; KAVITA</div>
      d/o Kevin Thomas Fernandes and Annie Kevin Fernandes.
    </div>

    <div class="event-details">
      <div class="event-row"><span class="event-label">On:</span><span class="event-value">Monday, 27 Oct 2025</span></div>
      <div class="event-row"><span class="event-label">Time:</span><span class="event-value">3:00 PM — <span class="map-link" onclick="openMap('cathedral')">Santa Cruz Cathedral Basilica, Fort Kochi</span></span></div>
      <div class="event-row"><span class="event-label">Reception:</span><span class="event-value">To follow at <span class="map-link" onclick="openMap('rose')">Rose Garden, Kochi</span></span></div>
      <div class="event-row"><span class="event-label">Home:</span><span class="event-value">Zion Villa, MLA Road, Pallurthy, Kochi 682006</span></div>
      <div class="event-row"><span class="event-label">Travel:</span><span class="event-value">Nearest Railway — Ernakulam Jn (ERS)<br>Nearest Airport — Cochin Intl.</span></div>
    </div>

    <div class="action-buttons">
      <button class="btn-primary" type="button" onclick="openRSVP('coming')">I’m coming</button>
      <button class="btn-outline" type="button" onclick="openRSVP('save')">Save the date</button>
    </div>

    <div class="color-note">Colour of the day — Wine Red</div>
  </div>

  <div class="countdown-section">
    <div style="margin:.25rem 0 .5rem;font-weight:700;letter-spacing:.08em">COUNTDOWN</div>
    <div class="countdown-timer" id="countdownTimer">Loading...</div>
  </div>

  <div class="footer">invite.nikagenyx.com · Kochi, Kerala</div>
</div>

<!-- RSVP -->
<div class="modal-overlay" id="rsvpModal" aria-modal="true" role="dialog">
  <div class="modal-content">
    <div class="modal-title">Save your reminder</div>
    <form id="rsvpForm">
      <div class="form-group">
        <label class="form-label" for="fullName">Full Name *</label>
        <input class="form-input" id="fullName" required>
      </div>
      <div class="form-group" id="guestCountGroup" style="display:none">
  <label class="form-label" for="guestCount">Number of Guests</label>
  <select class="form-input" id="guestCount">
    <option value="" selected disabled>Select</option>
    <option>1</option><option>2</option><option>3</option>
    <option>4</option><option>5</option><option>6</option>
    <option>7</option><option>8</option><option>9</option>
    <option>10</option>
  </select>
</div>

      <div style="display:flex;gap:.75rem;justify-content:center;margin-top:1rem">
        <button type="button" class="btn-cancel" onclick="closeRSVP()">Cancel</button>
        <button type="submit" class="btn-primary">Save &amp; Add to Calendar</button>
      </div>
    </form>
  </div>
</div>

<script>
/* ---------- Music (robust unlock) ---------- */
const bgm=document.getElementById('bgm');
const musicBtn=document.getElementById('musicControl');
let musicOn=false;
function uiMusic(on){ musicBtn.textContent=on?'Music: On':'Music: Off'; musicBtn.setAttribute('aria-pressed',String(on)); }
async function playMusic(){ try{ bgm.volume=.35; bgm.loop=true; await bgm.play(); musicOn=true; uiMusic(true);}catch{ musicBtn.textContent='🔈 Tap to play'; } }
function pauseMusic(){ bgm.pause(); musicOn=false; uiMusic(false); }
musicBtn.addEventListener('click',()=> musicOn?pauseMusic():playMusic());
(function unlockOnce(){ const once=()=>{ playMusic(); removeEventListener('pointerdown',once); removeEventListener('keydown',once); }; addEventListener('pointerdown',once,{passive:true}); addEventListener('keydown',once); })();
bgm.addEventListener('error',()=>{ musicBtn.textContent='🎵 Music unavailable'; });

/* ---------- Petals (fixed color per petal) ---------- */
class PetalsSystem{
  constructor(){ this.canvas=document.getElementById('petalsCanvas'); this.ctx=this.canvas.getContext('2d'); this.petals=[]; this.isActive=false; this.colors=['#7b1733','#a91d47','#c92a5a','#ff6b7a']; this.resize(); addEventListener('resize',()=>this.resize()); }
  resize(){ this.canvas.width=innerWidth; this.canvas.height=innerHeight; }
  createPetal(){ return { x:Math.random()*(this.canvas.width+200)-100, y:-30, size:Math.random()*8+4, speed:Math.random()*2+1, rotation:Math.random()*360, rotationSpeed:(Math.random()-.5)*4, opacity:.35+Math.random()*.45, color:this.colors[(Math.random()*this.colors.length)|0], drift:Math.random()*1.5-.75 }; }
  update(){ if(!this.isActive) return; if(Math.random()<0.3) this.petals.push(this.createPetal()); this.petals=this.petals.filter(p=>{ p.y+=p.speed; p.x+=Math.sin(p.y*.01)*p.drift; p.rotation+=p.rotationSpeed; return p.y<this.canvas.height+50; }); }
  draw(){ const c=this.ctx; c.clearRect(0,0,this.canvas.width,this.canvas.height); for(const p of this.petals){ c.save(); c.translate(p.x,p.y); c.rotate(p.rotation*Math.PI/180); c.globalAlpha=p.opacity; c.fillStyle=p.color; c.beginPath(); c.ellipse(0,0,p.size,p.size*.6,0,0,Math.PI*2); c.fill(); c.restore(); } }
  animate(){ this.update(); this.draw(); if(this.isActive) requestAnimationFrame(()=>this.animate()); }
  start(){ this.isActive=true; this.canvas.classList.add('active'); this.animate(); }
  burst(){ for(let i=0;i<50;i++) setTimeout(()=>this.petals.push(this.createPetal()), i*20); }
}
const petals=new PetalsSystem();

/* ---------- Intro text ---------- */
const introTexts=[
  "With great joy and gratitude",
  "Samson & Suni D'Costa",
  "Along With",
  "Kevin & Annie Fernandes",
  "Invite you to celebrate the wedding of",
  "Nikolas & Kavita",
  "On Monday, 27 Oct 2025",
  "At Santa Cruz Cathedral Basilica",
  "Reception to follow at Rose Garden"
];
let introStep=0, introTimer;
function startIntro(){ const seq=document.getElementById('introSequence'); const t=document.getElementById('introText'); seq.classList.remove('hidden'); introStep=0; introTimer=setInterval(()=>{ if(introStep<introTexts.length){ t.style.opacity='0'; setTimeout(()=>{ t.textContent=introTexts[introStep]; t.classList.toggle('intro-names', introStep===5); t.style.opacity='1'; introStep++; }, 400);} else { endIntro(); } }, 2200); }
function endIntro(){ clearInterval(introTimer); document.getElementById('introSequence').classList.add('hidden'); document.getElementById('mainContent').classList.add('visible'); }
document.getElementById('skipIntro').addEventListener('click', endIntro);

/* ---------- Heart gesture ---------- */
const heartBtn=document.getElementById('heartButton');
const namesWrap=document.getElementById('namesWrap');
function begin(){
  namesWrap.classList.add('name-merge');
  heartBtn.style.opacity='0';
  document.getElementById('touchIntro').classList.add('hidden');
  petals.start(); petals.burst();
  playMusic();               // definitely a gesture
  setTimeout(startIntro, 300);
}
heartBtn.addEventListener('click', begin, {passive:true});
heartBtn.addEventListener('touchstart', begin, {passive:true});
setTimeout(()=>heartBtn.classList.add('floating'), 900);

/* ---------- Maps ---------- */
function openMap(k){
  const m={
    cathedral:'https://maps.google.com/?q=Santa+Cruz+Cathedral+Basilica+Fort+Kochi',
    rose:'https://www.google.com/maps/place/Rose+Gardens+Function+Hall/@9.9189187,76.2647579,159m/data=!3m1!1e3!4m6!3m5!1s0x3b086d85e7dd2f4b:0xf685b03397b85806!8m2!3d9.9192535!4d76.2646839!16s%2Fg%2F11f00md17k?entry=ttu&g_ep=EgoyMDI1MDgzMC4wIKXMDSoASAFQAw%3D%3D'
  };
  window.open(m[k],'_blank');
}

/* ---------- Countdown ---------- */
function updateCountdown(){
  const target=new Date('2025-10-27T15:00:00+05:30').getTime();
  const now=Date.now(), diff=Math.max(0,target-now);
  const d=Math.floor(diff/86400000);
  const h=String(Math.floor(diff%86400000/3600000)).padStart(2,'0');
  const m=String(Math.floor(diff%3600000/60000)).padStart(2,'0');
  const s=String(Math.floor(diff%60000/1000)).padStart(2,'0');
  document.getElementById('countdownTimer').textContent = diff ? `${d} days ${h}:${m}:${s}` : "The big day is here! 🎉";
}
setInterval(updateCountdown,1000); updateCountdown();

/* ---------- RSVP + ICS (Reception updated to Rose Garden) ---------- */
let currentRSVPType = '';

function openRSVP(type){
  currentRSVPType = type;
  const group = document.getElementById('guestCountGroup');
  const select = document.getElementById('guestCount');

  if (type === 'coming') {
    group.style.display = 'block';
    select.required = true;
    select.value = '';               // force user to choose
  } else {
    group.style.display = 'none';
    select.required = false;
    select.value = '';
  }
  document.getElementById('rsvpModal').classList.add('visible');
}

document.getElementById('rsvpForm').addEventListener('submit', e => {
  e.preventDefault();

  const name = document.getElementById('fullName').value.trim();
  const guestCount = (currentRSVPType === 'coming')
    ? document.getElementById('guestCount').value
    : 1;

  if (!name) return;                       // native required covers this
  if (currentRSVPType === 'coming' && !guestCount) return; // select required

  downloadICS(makeICS(currentRSVPType), 'nikolas-kavita-wedding.ics');
  closeRSVP();
  alert(currentRSVPType === 'coming'
    ? `Thank you, ${name}! See you there 💕`
    : 'Saved! Hope to see you 💕');
});

function makeICS(type){
  const start='20251027T093000Z', end='20251027T103000Z';
  const trig = (type==='coming')?'-P7D':'-P30D';
  const desc = [
    'Wedding Ceremony at Santa Cruz Cathedral Basilica, Fort Kochi.',
    'Reception: Rose Gardens Function Hall, Kochi.',
    'Home: Zion Villa, MLA Road, Pallurthy, Kochi 682006.',
    'Travel: Ernakulam Jn (ERS) | Cochin Intl Airport.',
    'Maps:',
    'https://maps.google.com/?q=Santa+Cruz+Cathedral+Basilica+Fort+Kochi',
    'https://www.google.com/maps/place/Rose+Gardens+Function+Hall/@9.9189187,76.2647579,159m/data=!3m1!1e3!4m6!3m5!1s0x3b086d85e7dd2f4b:0xf685b03397b85806!8m2!3d9.9192535!4d76.2646839!16s%2Fg%2F11f00md17k?entry=ttu&g_ep=EgoyMDI1MDgzMC4wIKXMDSoASAFQAw%3D%3D'
  ].join('\\n');
  return `BEGIN:VCALENDAR
VERSION:2.0
CALSCALE:GREGORIAN
BEGIN:VEVENT
UID:${Date.now()}@invite.nikagenyx.com
DTSTAMP:${new Date().toISOString().replace(/[-:]/g,'').split('.')[0]}Z
SUMMARY:NIKOLAS & KAVITA — Wedding Ceremony
DESCRIPTION:${desc}
LOCATION:Santa Cruz Cathedral Basilica, Fort Kochi; Reception: Rose Gardens Function Hall, Kochi
DTSTART:${start}
DTEND:${end}
BEGIN:VALARM
ACTION:DISPLAY
DESCRIPTION:Wedding reminder
TRIGGER:${trig}
END:VALARM
END:VEVENT
END:VCALENDAR`;
}
function downloadICS(content,filename){
  const blob=new Blob([content],{type:'text/calendar;charset=utf-8'});
  const url=URL.createObjectURL(blob); const a=document.createElement('a');
  a.href=url; a.download=filename; document.body.appendChild(a); a.click();
  a.remove(); URL.revokeObjectURL(url);
}

/* ---------- Reduced motion ---------- */
if (window.matchMedia('(prefers-reduced-motion: reduce)').matches){
  document.getElementById('touchIntro').style.display='none';
  document.getElementById('introSequence').style.display='none';
  document.getElementById('mainContent').classList.add('visible');
}
</script>
</body>
</html>
